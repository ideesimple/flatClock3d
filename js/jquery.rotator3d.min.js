/* =============================================================
    // Mutli-screen flat 3D analogue clock (V2.7) with jQuery & CSS3 - No image, no webGL
    // By molokoloco@gmail.com 10/10/2011 - Edit 3D 28/05/2013
    // Demo : http://molokoloco.github.io/flatClock3d/
    // Infos : http://www.b2bweb.fr/coding-project/mutli-screen-flat-3d-analogue-clock-with-jquery-and-css3-v2-3/
    // jsFiddle 2D : http://jsfiddle.net/molokoloco/V2rFN/
    // jsFiddle + 3D : http://jsfiddle.net/molokoloco/x6yc3/
   =============================================================
 * // Usage example...

    var $cssBox3d = $('#rotator').rotator3d({
        shadow: $('#shadow'),
        reflet: $('#reflet'),
        refletBack: $('#refletBack'),
        rotationX: 6,
        rotationY: -18
    });
    
    $cssBox3d.rotator3d('toggle3d');

* ============================================================== */


!function(c){var d=function(a,e){this.settings=c.extend(!0,{},c.fn.rotator3d.defaults,"object"==typeof e&&e||{});this.element=a;this.shadow=this.settings.shadow;this.reflet=this.settings.reflet;this.refletBack=this.settings.refletBack;this.newRotationX=this.settings.rotationX;this.newRotationY=this.settings.rotationY;this.winH=this.winW=this.currentRotationY=this.currentRotationX=0;var b=this;c(window).on("resize",function(){b.winW=c(window).width();b.winH=c(window).height()}).trigger("resize");window.isMobile&&
window.addEventListener("deviceorientation",function(a){if(b.settings.moveMouseEnabled&&b.settings.is3D){var c=a.beta;a=a.gamma;b.newRotationY=window.isMozMobile?a:-a;b.newRotationX=window.isMozMobile?-c:c}},!1);var d=function(a){b.settings.moveMouseEnabled&&b.settings.is3D&&(b.newRotationY=0.15*-(a.pageX-0.5*b.winW),b.newRotationX=0.5*-(a.pageY-0.5*b.winH))};c(document).mouseenter(function(){b.settings.is3D&&(b.settings.moveMouseEnabled=!0,b.update(),document.addEventListener("pointermove",d))}).mouseleave(function(){b.settings.is3D&&
(document.removeEventListener("pointermove",d,!1),b.settings.moveMouseEnabled=!1,b.refresh())}).trigger("mouseenter");b.refresh();this.update()};d.prototype={constructor:d,limitedValue:function(a,c,b){a<=c?(a+=360,a<c&&(a=this.limitedValue(a,c,b))):a>b&&(a-=360,a>b&&(a=this.limitedValue(a,c,b)));return a},update:function(){if(this.settings.moveMouseEnabled&&this.settings.is3D){this.currentRotationX+=0.1*(this.newRotationX-this.currentRotationX);this.currentRotationY+=0.1*(this.newRotationY-this.currentRotationY);
if(parseInt(10*this.currentRotationY)!=parseInt(10*this.newRotationY)||parseInt(10*this.currentRotationX)!=parseInt(10*this.newRotationX))this.element.css({rotateY:this.currentRotationY+"deg",rotateX:this.currentRotationX+"deg"}),this.shadow&&this.shadow.css({transform:"translate3d(80px,80px,-400px) rotateY("+-this.currentRotationY+"deg) rotateX("+-this.currentRotationX+"deg) scale(1.5,1.5)"}),this.reflet&&this.reflet.css({backgroundPosition:-5*this.limitedValue(this.currentRotationY,-180,180)+"px 0px"}),
this.refletBack&&this.refletBack.css({backgroundPosition:5*(this.limitedValue(this.currentRotationY,0,360)-180)+"px 0px"});requestAnimationFrame(this.update.bind(this))}},toggle3d:function(){this.settings.is3D?(this.settings.is3D=!1,this.settings.moveMouseEnabled=!1,this.element.css({rotateX:0,rotateY:0}),this.shadow&&this.shadow.hide()):(this.settings.is3D=!0,this.settings.moveMouseEnabled=!0,this.shadow&&this.shadow.show(),this.update())},refresh:function(){this.element.css({rotateX:this.settings.rotationX,
rotateY:this.settings.rotationY});this.shadow&&this.shadow.css({transform:"translate3d(80px,80px,-400px) rotateY("+-this.settings.rotationY+"deg) rotateX("+-this.settings.rotationX+"deg) scale(1.5,1.5)"});this.reflet&&this.reflet.transition({backgroundPosition:-5*this.limitedValue(this.currentRotationY,-180,180)+"px 0px"},1200);this.refletBack&&this.refletBack.transition({backgroundPosition:5*(this.limitedValue(this.currentRotationY,0,360)-180)+"px 0px"},1200)}};var f=c.fn.rotator3d;c.fn.rotator3d=
function(a){return this.each(function(){var e=c(this),b=e.data("rotator3d");b||e.data("rotator3d",b=new d(e,a));if("string"==typeof a)b[a]()})};c.fn.rotator3d.Constructor=d;c.fn.rotator3d.defaults={shadow:null,reflet:null,refletBack:null,is3D:!0,moveMouseEnabled:!0,rotationX:0,rotationY:0,views:0};c.fn.rotator3d.noConflict=function(){c.fn.rotator3d=f;return this};c(window).on("load",function(){c('[data-rotator3d="true"]').each(function(){var a=c(this);a.rotator3d(a.data())})})}(window.jQuery);