/* =============================================================
    // Mutli-screen flat 3D analogue clock (V2.7) with jQuery & CSS3 - No image, no webGL
    // By molokoloco@gmail.com 05/2013
    
    // Demo : http://molokoloco.github.io/flatClock3d/
    // GitHub sources : https://github.com/molokoloco/flatClock3d
    // Infos : http://www.b2bweb.fr/coding-project/mutli-screen-flat-3d-analogue-clock-with-jquery-and-css3-v2-3/
    // jsFiddle 2D : http://jsfiddle.net/molokoloco/V2rFN/
    // jsFiddle + 3D : http://jsfiddle.net/molokoloco/x6yc3/
* ============================================================== */

!function(e){e.fn.extend({circalise:function(b){b=e.extend({targets:"> *",rotateTargets:!1,rotate3d:!1,startAngle:270,xRadius:null,yRadius:null},b||{});return this.each(function(){var a=e(this),h=parseInt(a.outerWidth(),10),c=parseInt(a.outerHeight(),10),l=a.find(b.targets),m=2*Math.PI/l.length,j=Math.PI*(b.startAngle/180);l.each(function(){var a=e(this),f=(h-parseInt(a.outerWidth(),10))/2,d=(c-parseInt(a.outerHeight(),10))/2,g=b.yRadius||0===b.yRadius?b.yRadius:d,g={left:(b.xRadius||0===b.xRadius?
b.xRadius:f)*Math.cos(j)+f,top:g*Math.sin(j)+d};if(b.rotateTargets||b.rotate3d)f=Math.atan2(g.top-d,g.left-f)+Math.PI/2,/e-/.test(f+"")&&(f=0),f+="rad",g.transform=b.rotate3d?"rotateX(90deg) rotateY("+f+")":"rotate("+f+")";a.transition(g,window.isMobile?0:800);j+=m});return a})},analogueClock:function(b){b=e.extend({withHours:!0,rotateHours:!0,withUnits:!0,withDigitalTime:!1,withDate:!1},b||{});return this.each(function(){var a=e(this),h=a.width(),c=a.height(),h=h/2,l=e('<div class="sec"><div class="clockwise"></div></div>').appendTo(a),
m=e('<div class="min"><div class="clockwise"></div></div>').appendTo(a),j=e('<div class="hour"><div class="clockwise"></div></div>').appendTo(a),p=b.withDigitalTime?e('<div class="time"></div>').appendTo(a):null,f=b.withDate?e('<div class="date"></div>').appendTo(a):null,d=e('<div class="innerCenter"></div>').appendTo(a);l.css({left:h-parseInt(l.width(),10)/2+"px",height:c+"px"});m.css({left:h-parseInt(m.width(),10)/2+"px",height:c+"px"});j.css({left:h-parseInt(j.width(),10)/2+"px",height:c+"px"});
d.css({margin:"-"+parseInt(d.height(),10)/2+"px 0 0 -"+parseInt(d.width(),10)/2+"px"});if(b.withHours){for(var g=12,k="",c=0;c<g;c++)k+='<div class="digit">'+(0==c%3?"<span>"+(0==c?g:c)+"</span>":c)+"</div>";a.append(k);a.circalise({targets:"div.digit",rotateTargets:b.rotateHours})}if(b.withUnits){g=12;k="";for(c=0;c<g;c++)k+='<div class="unit"></div>';a.append(k);c=parseInt(d.width(),10)/2-parseInt(a.find("div.unit").eq(0).outerHeight(),10)/2;d=parseInt(d.height(),10)/2-parseInt(a.find("div.unit").eq(0).outerHeight(),
10)/2;a.circalise({targets:".unit",rotateTargets:!0,xRadius:c,yRadius:d})}if(Modernizr.csstransforms3d){d="";for(c=0;50>c;c++)d+='<div class="side"></div>';e('<div id="clockBorder"/>').append(d).appendTo(a.parent()).circalise({targets:".side",rotate3d:!0,startAngle:0,xRadius:h,yRadius:h})}var n=function(){var a=new Date,c=a.getSeconds(),d=a.getMinutes(),e=a.getHours();l.css({transform:"rotate("+6*c+"deg)"});m.css({transform:"rotate("+6*d+"deg)"});j.css({transform:"rotate("+(30*e+d/2)+"deg)"});b.withDate&&
f.html(a.toString().split(a.getFullYear())[0]);b.withDigitalTime&&p.html(a.toString().split(a.getFullYear())[1].split(" ")[1]);setTimeout(n,300)};n();return a})}})}(window.jQuery);