/* =============================================================
    // Mutli-screen flat 3D analogue clock (V2.7) with jQuery & CSS3 - No image, no webGL
    // By molokoloco@gmail.com 05/2013
    
    // Demo : http://molokoloco.github.io/flatClock3d/
    // GitHub sources : https://github.com/molokoloco/flatClock3d
    // Infos : http://www.b2bweb.fr/coding-project/mutli-screen-flat-3d-analogue-clock-with-jquery-and-css3-v2-3/
    // jsFiddle 2D : http://jsfiddle.net/molokoloco/V2rFN/
    // jsFiddle + 3D : http://jsfiddle.net/molokoloco/x6yc3/
* ============================================================== */

!function(f){f.fn.extend({circalise:function(b){b=f.extend({targets:"> *",rotateTargets:!1,rotate3d:!1,startAngle:270,xRadius:null,yRadius:null},b||{});return this.each(function(){var a=f(this),h=parseInt(a.outerWidth(),10),c=parseInt(a.outerHeight(),10),l=a.find(b.targets),m=2*Math.PI/l.length,j=Math.PI*(b.startAngle/180);l.each(function(){var a=f(this),g=(h-parseInt(a.outerWidth(),10))/2,e=(c-parseInt(a.outerHeight(),10))/2,d=b.yRadius||0===b.yRadius?b.yRadius:e,d={left:(b.xRadius||0===b.xRadius? b.xRadius:g)*Math.cos(j)+g,top:d*Math.sin(j)+e};if(b.rotateTargets||b.rotate3d)g=Math.atan2(d.top-e,d.left-g)+Math.PI/2,/e-/.test(g+"")&&(g=0),d.transform=b.rotate3d?"translate("+d.left+"px, "+d.top+"px) rotateX(90deg) rotateY("+g+"rad)":"translate("+d.left+"px, "+d.top+"px) rotate("+g+"rad)",delete d.left,delete d.top;a.css(d);j+=m});return a})},analogueClock:function(b){b=f.extend({withHours:!0,rotateHours:!0,withUnits:!0,withDigitalTime:!1,withDate:!1},b||{});return this.each(function(){var a= f(this),h=a.width(),c=a.height(),h=h/2,l=f('<div class="sec"><div class="clockwise"></div></div>').appendTo(a),m=f('<div class="min"><div class="clockwise"></div></div>').appendTo(a),j=f('<div class="hour"><div class="clockwise"></div></div>').appendTo(a),p=b.withDigitalTime?f('<div class="time"></div>').appendTo(a):null,g=b.withDate?f('<div class="date"></div>').appendTo(a):null,e=f('<div class="innerCenter"></div>').appendTo(a);l.css({left:h-parseInt(l.width(),10)/2+"px",height:c+"px"});m.css({left:h- parseInt(m.width(),10)/2+"px",height:c+"px"});j.css({left:h-parseInt(j.width(),10)/2+"px",height:c+"px"});e.css({margin:"-"+parseInt(e.height(),10)/2+"px 0 0 -"+parseInt(e.width(),10)/2+"px"});if(b.withHours){for(var d=12,k="",c=0;c<d;c++)k+='<div class="digit">'+(0==c%3?"<span>"+(0==c?d:c)+"</span>":c)+"</div>";a.append(k);a.circalise({targets:"div.digit",rotateTargets:b.rotateHours})}if(b.withUnits){d=12;k="";for(c=0;c<d;c++)k+='<div class="unit"></div>';a.append(k);c=parseInt(e.width(),10)/2-parseInt(a.find("div.unit").eq(0).outerHeight(), 10)/2;e=parseInt(e.height(),10)/2-parseInt(a.find("div.unit").eq(0).outerHeight(),10)/2;a.circalise({targets:".unit",rotateTargets:!0,xRadius:c,yRadius:e})}if(Modernizr.csstransforms3d){e="";for(c=0;50>c;c++)e+='<div class="side"></div>';f('<div id="clockBorder"/>').append(e).appendTo(a.parent()).circalise({targets:".side",rotate3d:!0,startAngle:0,xRadius:h,yRadius:h})}var n=function(){var a=new Date,c=a.getSeconds(),d=a.getMinutes(),e=a.getHours();l.css({transform:"rotate("+6*c+"deg)"});m.css({transform:"rotate("+ 6*d+"deg)"});j.css({transform:"rotate("+(30*e+d/2)+"deg)"});b.withDate&&g.html(a.toString().split(a.getFullYear())[0]);b.withDigitalTime&&p.html(a.toString().split(a.getFullYear())[1].split(" ")[1]);setTimeout(n,300)};n();return a})}})}(window.jQuery);